<?php
namespace ifeiwu\log\adapter; use ifeiwu\log\AdapterAbstract; class File extends AdapterAbstract { protected $path; public function __construct($config) { $this->setPath(APP_PATH . $config['path'] ?: ini_get('error_log')); } public function error($message) { $this->_log('Error', $message, 'error.log'); } public function debug($message) { $this->_log('Debug', $message, 'debug.log'); } protected function _log($type, $message, $name) { $message = json_encode($this->_logs($message), JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT | JSON_FORCE_OBJECT); $message = date('[Y-m-d H:i:s e] ') . 'PHP ' . $type . ': '. "\n" . $message . "\n"; error_log($message, 3, $this->path . $name); } public function setPath($path) { if (!is_dir($path)) { mkdir($path, 0755, true); } $this->path = $path; } }