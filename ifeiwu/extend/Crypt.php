<?php
 class Crypt { public static function encrypt($str, $key) { $result = ''; for ($i = 0; $i < strlen($str); $i ++) { $char = substr($str, $i, 1); $keychar = substr($key, ($i % strlen($key)) - 1, 1); $char = chr(ord($char) + ord($keychar)); $result .= $char; } return static::encode_base64($result); } public static function decrypt($str, $key) { $result = ''; $str = static::decode_base64($str); for ($i = 0; $i < strlen($str); $i ++) { $char = substr($str, $i, 1); $keychar = substr($key, ($i % strlen($key)) - 1, 1); $char = chr(ord($char) - ord($keychar)); $result .= $char; } return $result; } private static function encode_base64($str) { return strtr(base64_encode($str), '+/', '-_'); } private static function decode_base64($str) { return base64_decode(strtr($str, '-_', '+/')); } } 